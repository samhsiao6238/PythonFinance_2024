# Selenium

[參考](https://www.npmjs.com/package/chromedriver) 

<br>

## 一般安裝

_無論 MacOS 或是 Win 皆相同，關於安裝的補充會在後續說明_

<br>

1. 直接安裝。

    ```bash
    pip install selenium
    ```
<br>

是的，新版的 Selenium（4.x 版本） 相較於舊版（3.x 及更早版本）有許多 API 變更，尤其是在 瀏覽器驅動管理、元素查找、等待機制、以及與 WebDriver 交互的方式 上有顯著不同。



## 新版 Selenium (4.x) vs 舊版 (3.x) 的主要變更
### 1️⃣ 不再需要手動下載 WebDriver
舊版 Selenium 需要手動下載 `chromedriver`、`geckodriver` 等驅動程式，並將其路徑傳入 `webdriver.Chrome(executable_path="path")`。

✅ 新版 Selenium 內建了 WebDriver 管理工具：
```python
from selenium import webdriver

# 不需要手動下載 `chromedriver`，Selenium 會自動安裝與管理
driver = webdriver.Chrome()  
```
> 變更點：新版不再使用 `executable_path`，而是讓 `webdriver.Chrome()` 直接管理 WebDriver 下載與更新。



### 2️⃣ `find_element` 需使用 `By`
舊版 Selenium 允許直接傳入 `find_element_by_*` 方法：
```python
element = driver.find_element_by_id("username")
```
✅ 新版 Selenium 4.x 強制要求使用 `By` 模組
```python
from selenium.webdriver.common.by import By

element = driver.find_element(By.ID, "username")
```
> 變更點：舊版的 `find_element_by_id`、`find_element_by_class_name` 都已棄用，需要改用 `By.ID`、`By.CLASS_NAME`。

完整對照：
| 舊版 (3.x) | 新版 (4.x) |
|||
| `find_element_by_id("id")` | `find_element(By.ID, "id")` |
| `find_element_by_class_name("class")` | `find_element(By.CLASS_NAME, "class")` |
| `find_element_by_xpath("//div")` | `find_element(By.XPATH, "//div")` |
| `find_element_by_css_selector(".class")` | `find_element(By.CSS_SELECTOR, ".class")` |



### 3️⃣ `ActionChains`、`wait` API 變更
✅ `ActionChains` 變更
舊版：
```python
from selenium.webdriver.common.action_chains import ActionChains

actions = ActionChains(driver)
actions.move_to_element(element).perform()
```
新版：
```python
from selenium.webdriver.common.action_chains import ActionChains

actions = ActionChains(driver)
actions.scroll_to_element(element).perform()  # Selenium 4 新增的 `scroll_to_element`
```

✅ `wait` API 變更
舊版：
```python
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

WebDriverWait(driver, 10).until(EC.presence_of_element_located(("id", "username")))
```
新版（`By` 必須顯式指定）
```python
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.by import By

WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.ID, "username")))
```



### 4️⃣ 滾動與視窗管理 API
Selenium 4.x 提供了更好的滾動與視窗管理功能
```python
# 滾動到特定元素
driver.execute_script("arguments[0].scrollIntoView();", element)

# 獲取當前視窗大小
size = driver.get_window_rect()
print(size)
```



### 5️⃣ 內建支援 `relative locators`（相對定位）
新版 Selenium 4.x 允許相對於其他元素來尋找目標元素：
```python
from selenium.webdriver.common.by import By
from selenium.webdriver.support.relative_locator import locate_with

# 找到某個元素"旁邊"的按鈕
element = driver.find_element(locate_with(By.TAG_NAME, "button").to_right_of(By.ID, "login-form"))
```
這對於無法直接定位的元素（例如動態產生的按鈕）很有幫助。



## 總結
| 變更項目 | Selenium 3.x | Selenium 4.x |
||||
| WebDriver 管理 | `executable_path="chromedriver"` | `webdriver.Chrome()` 自動管理 |
| 元素查找 | `find_element_by_*` | `find_element(By.*, "值")` |
| 等待機制 | 允許 `find_element_by_id` | 需要 `By.ID` 顯式指定 |
| 滾動操作 | 需要 `JavaScript` | 內建 `scroll_to_element()` |
| 相對定位 | ❌ | ✅ `locate_with()` |

> 結論：
- ✅ 新版 Selenium 4.x 更簡潔，並且 API 更加標準化。
- ✅ WebDriver 不需要手動下載，降低了環境配置的麻煩。
- ❗ 如果你的程式碼仍然使用 `find_element_by_*`，需要進行改寫！

你目前的 Selenium 代碼是否需要升級？如果需要，我可以幫你優化！🚀


___

_END_