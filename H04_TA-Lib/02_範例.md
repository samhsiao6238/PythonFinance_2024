# 技術指標

<br>

## ADX

_Average Directional Index，平均方向指數_

<br>

1. 這個指標用來衡量市場趨勢的強度，範圍在 `0~100` 之間，低於 20 表示趨勢較弱或無趨勢，20-40 表示趨勢較強，40-60 表示趨勢非常強，高於 60 表示極端強勢趨勢。

<br>

2. 可簡化分水嶺，當 ADX > 25 代表有趨勢且越高趨勢越強；反之若 ADX < 20 代表市場波動較小，沒有明確趨勢。

<br>

3. 計算方式基於 +DI（正向指標） 和 -DI（負向指標），但 `ADX` 只關注趨勢強度，而不考慮方向。

<br>

## BBANDS

_Bollinger Bands，布林通道_

<br>

1. 這是一種 波動率指標，用來判斷價格是高估還是低估；上軌（Upper Band）= 20 日均線 + 2 倍標準差，中軌（Middle Band）= 20 日均線（SMA），下軌（Lower Band） = 20 日均線 - 2 倍標準差。

<br>

2. 價格如果接近 上軌，表示可能超買；如果接近 下軌，表示可能超賣。

<br>

## 代碼

1. 以下代碼讀取前面步驟儲存的數據檔案 `excel_file_path`，若有變更可逕自修改；首先轉換 `High`、`Low`、`Close` 為 NumPy 陣列，避免 `TA-Lib` 錯誤，接著計算 `BBANDS` 與 `ADX` 的三條軌道線，並將數據存入 Excel 並顯示最後 10 筆數據。

    ```python
    import pandas as pd
    import numpy as np
    import talib

    # 讀取 Excel 檔案
    df = pd.read_excel(excel_file_path)

    # 確保欄位名稱正確
    print(df.head())

    # 轉換數據格式為 NumPy 陣列，避免 `TA-Lib` 無法運行
    high = df["High"].values.astype(np.float64)
    low = df["Low"].values.astype(np.float64)
    close = df["Close"].values.astype(np.float64)

    # 計算 ADX，趨勢強度指標
    df["ADX"] = talib.ADX(high, low, close, timeperiod=14)
    # 計算 BBANDS，布林通道
    df["UpperBand"], df["MiddleBand"], df["LowerBand"] = talib.BBANDS(
        close, timeperiod=20, nbdevup=2, nbdevdn=2, matype=0
    )
    # 顯示最後 10 筆數據
    print(df.tail(10))
    # 儲存結果到 Excel
    output_file = "data/股市資料_ADX_BBANDS.xlsx"
    df.to_excel(output_file, index=False)
    print(f"結果已儲存到 {output_file}")
    ```

<br>

___

_END_
