# 簡繁轉換操作指引

_使用 `CN2TW_md_translator.py` 將 `.md` 文件中的簡體中文轉換為繁體中文，並保持英文與程式碼內容不變。_

<br>

## 編寫腳本

_此腳本可用於快速進行 Markdown 文件的簡繁轉換。_

<br>

1. 在專案資料夾中建立一個 Python 腳本，命名為 `CN2TW_md_translator.py`，並使用以下代碼。

    ```python
    import sys
    import zhconv
    import re

    def simplify_to_traditional(text):
        """將簡體中文轉換為繁體中文"""
        return zhconv.convert(text, 'zh-tw')

    def is_chinese(text):
        """檢查字串是否包含中文"""
        return bool(re.search(r'[\u4e00-\u9fff]', text))

    def translate_md_file(input_file, output_file):
        """讀取 .md 文件，轉換簡體為繁體，保持英文與程式碼不變"""
        with open(input_file, 'r', encoding='utf-8') as file:
            content = file.readlines()

        translated_lines = []
        code_block = False  # 用於標記是否在程式碼區塊內

        for line in content:
            # 檢查是否進入或退出程式碼區塊 (```)
            if line.strip().startswith("```"):
                code_block = not code_block
                translated_lines.append(line)
                continue

            if code_block:
                # 在程式碼區塊內，但仍然轉換包含中文的部分
                translated_line = re.sub(r'([\u4e00-\u9fff]+)', lambda m: simplify_to_traditional(m.group(0)), line)
            else:
                # 非程式碼區塊，完全轉換
                translated_line = simplify_to_traditional(line)

            translated_lines.append(translated_line)

        # 寫入新的繁體中文 .md 文件
        with open(output_file, 'w', encoding='utf-8') as file:
            file.writelines(translated_lines)

        print(f"翻譯完成，結果已儲存至 {output_file}")

    if __name__ == "__main__":
        if len(sys.argv) != 3:
            print("使用方式: python CN2TW_md_translator.py <輸入文件.md> <輸出文件.md>")
            sys.exit(1)

        input_md = sys.argv[1]
        output_md = sys.argv[2]

        translate_md_file(input_md, output_md)
    ```

2. 安裝 `zhconv` 以支援簡繁轉換。

    ```bash
    pip install zhconv
    ```

3. 使用以下指令執行腳本進行轉換，`input.md` 是原始簡體中文 Markdown 文件，`output.md` 是轉換後的繁體中文 Markdown 文件。

    ```bash
    python CN2TW_md_translator.py input.md output.md
    ```


<br>

## 快速鍵

_在 VSCode 中設置快捷鍵，以便快速執行轉換腳本。_

<br>

1. 開啟 VSCode，進入 `.vscode` 目錄，建立 `tasks.json` 文件。

2. 在 `tasks.json` 文件中新增以下內容；`${file}` 是當前開啟的 `.md `文件，也就是要轉換的簡體版本文件，`"command": "python"` 會讓 VSCode 執行 `CN2TW_md_translator.py`；`${fileDirname}/${fileBasenameNoExtension}_tw.md` 會將轉換後的繁體 `.md 文件` 添加後綴儲存。

    ```json
    {
        "version": "2.0.0",
        "tasks": [
            {
                "label": "Translate Current Markdown (CN → TW)",
                "type": "shell",
                "command": "python",
                "args": [
                    "${workspaceFolder}/CN2TW_md_translator.py",
                    "${file}",
                    "${fileDirname}/${fileBasenameNoExtension}_tw.md"
                ],
                "presentation": {
                    "reveal": "always",
                    "panel": "shared"
                },
                "problemMatcher": []
            }
        ]
    }
    ```

3. 編輯後，點擊 `SHIFT + COMMAND + P`，選取 `Tasks: Run Task` 便可執行該轉換腳本。

<br>

## 其他設置

_在 `settings.json` 中設置 Python 環境。_

1. 編輯 VSCode `settings.json`，新增 Python 路徑。

    ```json
    {
        "python.defaultInterpreterPath": "<Python-的全域路徑>/python",
        "editor.codeActionsOnSave": {
            "source.organizeImports": true
        }
    }
    ```

<br>

___

_END_

