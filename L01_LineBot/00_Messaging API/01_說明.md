# LINE Messaging API 發送通知

_LINE Notify 服務於 `2025/3/31` 終止，官方建議使用 `Messaging API` 取代。_

## 登入開發帳號

1. 登入 [LINE Developers Console](https://developers.line.biz/console/)，建立新的或使用既有的 Messaging API 項目。

2. 進入 Messaging API 設定，找到 `Channel Access Token`，點選 Issue 來生成。

## 發送 LINE 訊息

1. 使用 `requests` 模組來發送訊息給你的 LINE 官方帳號好友。

```python
import requests

# 設定你的 Channel Access Token
CHANNEL_ACCESS_TOKEN = "你的 Channel Access Token"

# 設定接收者的 User ID
USER_ID = "接收者的 LINE User ID"

# 設定 API URL
API_URL = "https://api.line.me/v2/bot/message/push"

# 訊息內容
headers = {
    "Content-Type": "application/json",
    "Authorization": f"Bearer {CHANNEL_ACCESS_TOKEN}"
}

data = {
    "to": USER_ID,
    "messages": [
        {
            "type": "text",
            "text": "這是一則來自 Messaging API 的通知訊息！"
        }
    ]
}

# 發送請求
response = requests.post(API_URL, headers=headers, json=data)

# 輸出結果
print(response.status_code)
print(response.json())
```

## 如何取得 `User ID`

1. 在 [LINE Developers Console](https://developers.line.biz/console/)，找到 Webhook 設定 並啟用 Webhook URL。

2. 讓使用者 向你的官方帳號發送訊息，然後透過 Webhook 捕捉 `User ID`，或透過 [Get Profile API](https://developers.line.biz/en/reference/messaging-api/#get-profile) 取得。

## 使用 Webhook 自動回應

1. 若希望 LINE 官方帳號 自動回應，可以在 Webhook 伺服器 監聽 LINE 傳來的訊息。

```python
from flask import Flask, request, jsonify

app = Flask(__name__)

@app.route("/webhook", methods=["POST"])
def webhook():
    body = request.json
    # 印出收到的訊息
    print(body)

    return jsonify({"status": "success"}), 200

if __name__ == "__main__":
    app.run(port=5000)
```

你可以 將這個 Flask 伺服器部署到雲端（如 AWS、GCP、Heroku），並將 Webhook URL 設定於 LINE Developers Console，讓你的 LINE 官方帳號自動處理訊息。



### Messaging API 的費用與限制
1. 免費方案（Trial）：
   - 每個月最多發送 500 則訊息。
   - 過量後 無法發送，需升級付費方案。
2. 付費方案：依照發送訊息的數量計費，詳情請參閱：
   - [Messaging API Pricing](https://www.linebiz.com/tw/service/messaging-api/#pricing)


