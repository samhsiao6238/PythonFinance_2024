# 顯示為文字雲


## 環境建置

1. 安裝套件。

```bash
pip install wordcloud matplotlib
```

2. 尋找字形，例如 `PingFang.ttc`。

    ```bash
    cd /System/Library/Fonts && ls PingFang.ttc
    ```

3. 將字形檔案拷貝到專案同層資料夾使用。

![](images/img_86.png)

## 腳本


1. 完整腳本。

```python
# 導入庫
from pymongo.mongo_client import MongoClient
from wordcloud import WordCloud
import matplotlib.pyplot as plt

#
font_path = 'PingFang.ttc'
# MongoDB連接設定
uri = "mongodb+srv://sam6238:sam112233@cluster0.yhwvqqt.mongodb.net/?retryWrites=true&w=majority&appName=Cluster0"
client = MongoClient(uri)

# 建立MongoDB資料庫和集合
mongodb = client['MyDatabase2024']
collection = mongodb['MyCollection2024']

# 從MongoDB讀取資料並建立text字串
text = ""
try:
    documents = collection.find({})
    for document in documents:
        # 加入product_name欄位的內容
        text += " " + document.get('product_name', '')
        # 遍歷文件中的其他欄位（商品名稱），忽略'_id'字段
        for key in document:
            if key not in ['_id', 'product_name']:
                text += " " + key  # 加入其他商品的名稱
    if text.strip():  # 確保text不是空的
        print("成功從MongoDB讀取資料並建立文字雲.")
    else:
        print("文檔可能不存在'product_name'字段，或沒有文檔被讀取。")
except Exception as e:
    print(f"從MongoDB讀取資料時發生錯誤: {e}")
finally:
    client.close()

# 產生和顯示文字雲（只有當text不是空的時候）
if text.strip():
    wordcloud = WordCloud(
        font_path=font_path,
        width=800, height=800,
        background_color='white',
        stopwords=None,
        min_font_size=10).generate(text)

    plt.figure(figsize=(8, 8), facecolor=None)
    plt.imshow(wordcloud)
    plt.axis("off")
    plt.tight_layout(pad=0)

    plt.show()
else:
    print("沒有可用於生成文字雲的文字。")
```

2. 輸出結果。

![](images/img_87.png)