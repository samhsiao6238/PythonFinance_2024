# 歷史匯率

_取得指定匯率的歷史資訊_


## 台銀 API

1. 官網 [台灣銀行匯率查詢](https://rate.bot.com.tw/)。

2. API 範例 `https://rate.bot.com.tw/xrt/flcsv/0/day`。

3. 取得過去一個月某特定貨幣的匯率資料。

```python
import pandas as pd

url = "https://rate.bot.com.tw/xrt/flcsv/0/day"
# 用 UTF-8 讀取
df = pd.read_csv(url, encoding="utf-8")
# 顯示前幾筆資料
print(df.head())
```

## 使用 ExchangeRate-API

_提供全球匯率資訊_

1. 官網 [ExchangeRate-API](https://www.exchangerate-api.com/)，完成註冊後會寄發 Email，API Key 會在信件中提供，同時提示了基本使用範例。

```bash
https://v6.exchangerate-api.com/v6/<我的-API_KEY>/latest/USD
```

2. 範例。

```python
import requests

API_KEY = "你的 API Key"
base_currency = "USD"
target_currency = "TWD"
# 查詢的歷史日期
date = "2023-12-01"

# API URL
url = f"https://v6.exchangerate-api.com/v6/{API_KEY}/history/{base_currency}/{date}"

# 發送請求
response = requests.get(url)
data = response.json()

# 取得匯率
rate = data["conversion_rates"].get(target_currency)
print(f"{base_currency} 兌換 {target_currency} 在 {date} 的匯率為: {rate}")
```

## 使用 twder

1. 安裝 twder。

```bash
pip install CurrencyConverter
```

2. 範例。

```python
from currency_converter import CurrencyConverter

# 初始化 CurrencyConverter
c = CurrencyConverter()

# 查詢 USD 對 TWD 的匯率
try:
    usd_to_twd_rate = c.convert(1, 'USD', 'TWD')
    print(f"1 美元 = {usd_to_twd_rate:.2f} 新台幣")
except ValueError as e:
    print(f"錯誤：{e}")
```





## 方法 4：使用 Selenium 爬取指定銀行匯率
如果某銀行沒有提供 API，可以使用 `selenium` 爬取其官網數據。

### 安裝套件
```bash
pip install selenium
```

### 爬取範例
（以中國信託為例）
```python
from selenium import webdriver
from selenium.webdriver.common.by import By

# 啟動瀏覽器
driver = webdriver.Chrome()

# 目標網址（需更換為實際匯率頁面）
url = "https://www.ctbcbank.com/twrate/"
driver.get(url)

# 抓取歷史匯率表格
table = driver.find_element(By.CLASS_NAME, "rate-table")
print(table.text)

# 關閉瀏覽器
driver.quit()
```
🔹 此方法適合無 API 的銀行，但需要根據網站 HTML 結構調整爬取邏輯。



## 總結
| 方法 | 適用情境 | 優點 | 缺點 |
|||||
| 台灣銀行 API | 查詢台灣銀行匯率 | 無需登入，數據可靠 | 無法查詢特定日期 |
| ExchangeRate-API | 國際匯率 | 提供歷史數據 | 需要 API Key，部分免費限制 |
| Yahoo Finance | 查詢主要貨幣對 | 簡單易用，可查歷史數據 | 無法查詢特定銀行的匯率 |
| Selenium 爬取 | 特定銀行牌告匯率 | 適用無 API 網站 | 需維護爬蟲代碼，可能受反爬機制影響 |


🔹 建議：
- 若查詢台灣銀行的匯率，可直接使用 方法 1。
- 若需要全球歷史匯率，可使用 方法 2 或 3。
- 若需爬取特定銀行的歷史數據，可用 方法 4。

請問你的需求是哪種呢？需針對哪家銀行或哪個貨幣對？