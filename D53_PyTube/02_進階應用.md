# 進階應用

## 視頻格式轉換

1. 可使用 Python 和第三方工具如 `ffmpeg` 來轉換視頻格式。

```python
import subprocess

# 定義輸入和輸出文件
input_file = "input_video.mp4"
output_file = "output_video.avi"

# 使用 ffmpeg 進行格式轉換
subprocess.run(['ffmpeg', '-i', input_file, output_file])
```

## 提取音頻

1. 如果只需要影片中的音頻，可使用 `ffmpeg` 或 `pydub` 模組來提取音頻並保存為 MP3 或其他格式。

```python
from pydub import AudioSegment

# 讀取影片文件
video = AudioSegment.from_file("input_video.mp4", "mp4")

# 將音頻部分保存為 mp3
video.export("output_audio.mp3", format="mp3")
```

## 影片剪輯與合併

1. Python 可使用 `moviepy` 模組實現剪輯或合併影片。

```python
from moviepy.editor import VideoFileClip, concatenate_videoclips

# 讀取影片片段
clip1 = VideoFileClip("clip1.mp4")
clip2 = VideoFileClip("clip2.mp4")

# 合併影片片段
final_clip = concatenate_videoclips([clip1, clip2])

# 保存合併後的影片
final_clip.write_videofile("merged_video.mp4")
```

## 影片壓縮

1. 為了節省空間或減少上傳時間，可使用 Python 壓縮影片；`ffmpeg` 提供了一種減少文件大小的方法，同時保持合理的畫質。

```python
import subprocess

# 使用 ffmpeg 進行影片壓縮
subprocess.run([
    'ffmpeg', '-i', 'input_video.mp4', '-vcodec', 'libx265', '-crf', '28', 'compressed_video.mp4'
])
```

## 自動化工作流程

1. 可編寫腳本自動下載和處理多個影片；例如從不同的 URL 列表中下載影片，然後批量轉換或壓縮它們。

```python
import yt_dlp
import subprocess

def download_and_compress(url, output_path):
    ydl_opts = {
        'format': 'best',
        'outtmpl': f'{output_path}/%(title)s.%(ext)s'
    }
    
    with yt_dlp.YoutubeDL(ydl_opts) as ydl:
        ydl.download([url])

    # 假設下載的文件是 mp4 格式
    input_file = f"{output_path}/downloaded_video.mp4"
    compressed_file = f"{output_path}/compressed_video.mp4"
    subprocess.run(['ffmpeg', '-i', input_file, '-vcodec', 'libx265', '-crf', '28', compressed_file])

# 從 URL 列表中批量處理
urls = ["https://www.youtube.com/watch?v=xxxx", "https://www.youtube.com/watch?v=yyyy"]
for url in urls:
    download_and_compress(url, "/path/to/output")
```

## 影片字幕提取與處理

1. 如果影片包含字幕，可以使用 Python 提取和處理字幕，例如生成字幕文件如 SRT 或進行語音轉文字處理。

```python
import yt_dlp

URL = "https://www.youtube.com/watch?v=example"

ydl_opts = {
    'writesubtitles': True,
    'subtitlesformat': 'srt',
    'skip_download': True
}

with yt_dlp.YoutubeDL(ydl_opts) as ydl:
    ydl.download([URL])
```

## 影片分析與特徵提取

1. 可使用電腦視覺技術如 OpenCV 和 PyTorch 對影片進行分析和特徵提取，這在研究、視頻監控、動作識別等領域非常有用。

```python
import cv2

# 讀取影片
cap = cv2.VideoCapture('input_video.mp4')

while(cap.isOpened()):
    ret, frame = cap.read()
    if ret:
        # 在這裡處理每個影格，例如進行邊緣檢測
        edges = cv2.Canny(frame, 100, 200)
        cv2.imshow('Edges', edges)
        
        if cv2.waitKey(1) & 0xFF == ord('q'):
            break
    else:
        break

cap.release()
cv2.destroyAllWindows()
```

## 自動上傳處理後的影片

1. 可將處理過的影片自動上傳到雲端存儲或視頻平台，如 YouTube 或 Vimeo）。

```python
from googleapiclient.discovery import build
from googleapiclient.http import MediaFileUpload

# 假設已經設置了 API 客戶端
youtube = build('youtube', 'v3', developerKey='YOUR_API_KEY')

request_body = {
    'snippet': {
        'title': 'My Uploaded Video',
        'description': 'Description of the video.',
        'tags': ['sample', 'video', 'upload'],
        'categoryId': '22'
    },
    'status': {
        'privacyStatus': 'public'
    }
}

media = MediaFileUpload('processed_video.mp4')

# 上傳影片
request = youtube.videos().insert(
    part='snippet,status',
    body=request_body,
    media_body=media
)

response = request.execute()
```

